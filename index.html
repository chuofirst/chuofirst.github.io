<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="中央中等生ファーストの会は、中央中等生の未来をより良くするために活動する政治団体です。">
        <title>中央中等生ファーストの会</title>
        <link rel="stylesheet" href="ChuoFirst.css">
        <link rel="icon" type="image/png" href="ChuoFirst_icon.png">
        <style>
            body {
                visibility: visible;
            }
        </style>
        <!-- OGP設定 -->
        <meta property="og:title" content="中央中等生ファーストの会">
        <meta property="og:description" content="中央中等生の未来をより良くするために活動する政治団体">
        <meta property="og:image" content="ChuoFirst.png">
        <meta property="og:type" content="website">
    </head>
    <body>
        <header>
            <div class="header-left">
                <a href="index.html" aria-label="ホームページへ戻る">
                    <div class="logo">
                        <img src="ChuoFirst_icon.png" alt="中央中等生ファーストの会ロゴ" width="70" height="70">
                    </div>
                    <div class="logo-text">中央中等生ファーストの会</div>
                </a>
            </div>
            <button class="menu-toggle" id="menu-toggle" aria-label="メニューを開く" aria-expanded="false">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <nav id="nav-menu" aria-label="メインナビゲーション">
                <a href="aboutus.html">私たちについて</a>
                <a href="member.html">メンバー</a>
                <a href="news.html">ニュース</a>
                <a href="policy.html">政策</a>
                <a href="active.html">活動</a>
                <a href="recruit.html">候補者公募</a>
            </nav>
        </header>
        <div id="overlay" aria-hidden="true"></div>
        <!-- ヒーローセクション -->
        <section class="hero" aria-label="トップビジュアル">
            <img src="Thegirl.jpg" alt="" class="hero-image" width="1920" height="1080">
            <div class="hero-overlay">
                <img src="ChuoFirst.png" alt="中央中等生ファーストの会" class="hero-logo-left">
                <img src="手書き文字.png" alt="中央中等生ファーストの会" class="hero-logo-right">
            </div>
        </section>
        <main id="main-content">
     <!-- ポスターセクション -->
        <section class="poster-section" aria-labelledby="poster-heading">
          <h2 id="poster-heading" class="poster-heading">ポスター2025</h2>

          <div class="poster-container">
      <!-- 左側テキスト（元のまま） -->
          <div class="poster-text">
            <p class="poster-title"><span class="black-text">中央中等生</span><br>ファーストの会</p>
          </div>
            
       <!-- 右側ポスター画像：初期は軽いプレビュー→見えたら復号して差し替え -->
            <div class="poster-image">
      <!-- プレビュー（軽い画像を用意できなければ小さめJPG/PNGでもOK） -->
        <img id="posterPlaceholder"
             src="ChuoFirst_poster_preview.webp"
             alt="ポスター（読み込み中）"
             width="1080" height="1350"
             loading="lazy" decoding="async"
             style="display:block;filter:blur(6px);">

      <!-- 復号用：元の data-encrypted-src を “まるごと” この属性値に貼るだけ -->
      <div id="posterDecrypt"
           data-encrypted-src="（ここに元の data-encrypted-src の長い文字列をそのまま貼る）">
      </div>
    </div>
  </div>
</section>

<script>
  (function () {
    const holder = document.getElementById('posterDecrypt');
    const ph = document.getElementById('posterPlaceholder');
    if (!holder) return;

    // 既存の復号関数に合わせて自動検出（なければ関数名を decrypt に統一しておいて）
    const decryptFn = window.decrypt || window.decryptImage || window.decodeImage;
    async function getDecryptedUrl() {
      const enc = holder.getAttribute('data-encrypted-src');
      if (!enc) return null;
      if (typeof decryptFn === 'function') {
        try { return await decryptFn(enc); } catch (e) { console.error(e); return null; }
      }
      console.warn('復号関数が見つかりません。window.decrypt などを定義してください。');
      return null;
    }

    function mountDecrypted(url) {
      if (!url) return;
      const img = new Image();
      img.src = url;
      img.alt = '中央中等生ファーストの会 ポスター';
      img.width = 1080; img.height = 1350;
      img.loading = 'lazy'; img.decoding = 'async';
      img.style = 'display:block';
      img.addEventListener('load', () => {
        if (ph && ph.parentNode) ph.replaceWith(img);
      });
    }

    async function loadWhenVisible() {
      const io = new IntersectionObserver(async (entries) => {
        if (entries.some(e => e.isIntersecting)) {
          io.disconnect();
          const url = await getDecryptedUrl();
          mountDecrypted(url);
        }
      }, { rootMargin: '200px' });
      io.observe(holder);
    }

    if ('IntersectionObserver' in window) {
      loadWhenVisible();
    } else {
      // 古いブラウザ：即復号（フォールバック）
      getDecryptedUrl().then(mountDecrypted);
    }
  })();
</script>
<!-- ▲▲ ここまで：ポスターセクション（② 見えたら復号） ▲▲ -->

            <!-- メッセージセクション -->
            <section class="message-section" aria-labelledby="message-heading">
                <h2 id="message-heading" class="visually-hidden">私たちのメッセージ</h2>
                <p>
                    今のままでは中等生が中等生ではなくなってしまう<br>
                    中央中等生ファーストの会はそんな危機感から有志が集まり、ゼロからつくった政党です。<br>
                    私たちには特定の支援団体も資金源もありません。<br>
                    同じ想いを持った普通の中等生が集まり、<br>
                    「後輩の世代により良い中等を残したい」<br>という想いひとつで活動を続けています。
      
                </p>
            </section>
            <!-- SNSセクション -->
            <section class="sns-section" aria-labelledby="sns-heading">
                <h2 id="sns-heading" class="sns-heading">SNS</h2>
                <div class="sns-content">
                    <p class="sns-name">Instagram</p>
                    <div class="instagram-embed" id="instaLazy" data-permalink="https://www.instagram.com/p/DQUZ2NKkjL9/?utm_source=ig_embed&amp;utm_campaign=loading">
                        <div aria-hidden="true" style="height:0.5rem;"></div>
                    </div>
                    <script>
                        (function() {
                            const c = document.getElementById('instaLazy');
                            if (!c)
                                return;
                            function load() {
                                if (c.dataset.loaded)
                                    return;
                                c.dataset.loaded = '1';
                                const b = document.createElement('blockquote');
                                b.className = 'instagram-media';
                                b.setAttribute('data-instgrm-captioned', '');
                                b.setAttribute('data-instgrm-permalink', c.getAttribute('data-permalink'));
                                b.setAttribute('data-instgrm-version', '14');
                                b.style.cssText = 'background:#FFF;border:0;border-radius:3px;box-shadow:0 0 1px 0 rgba(0,0,0,.5),0 1px 10px 0 rgba(0,0,0,.15);margin:1px auto;max-width:540px;min-width:326px;padding:0;';
                                c.appendChild(b);
                                const s = document.createElement('script');
                                s.async = true;
                                s.src = 'https://www.instagram.com/embed.js';
                                document.body.appendChild(s);
                            }
                            if ('IntersectionObserver'in window) {
                                const io = new IntersectionObserver(es => {
                                    if (es.some(e => e.isIntersecting)) {
                                        io.disconnect();
                                        load();
                                    }
                                }
                                ,{
                                    rootMargin: '200px'
                                });
                                io.observe(c);
                            } else {
                                load();
                            }
                        }
                        )();
                    </script>
                </div>
            </section>
        </main>
        <footer>
            <div class="footer-content">
                <div class="footer-contact">
                    <a href="form.html">お問い合わせ</a>
                </div>
                <a href="https://chuofirst.github.io" aria-label="ホームページへ戻る">
                    <img src="ChuoFirst.png" alt="中央中等生ファーストの会" class="footer-logo" width="300" height="100" loading="lazy">
                </a>
                <a href="https://www.instagram.com/chuo.first/" target="_blank" rel="noopener noreferrer" aria-label="Instagramで中央中等生ファーストの会をフォロー">
                    <img src="instagram.jpg" alt="" class="footer-instagram" width="50" height="50" loading="lazy">
                </a>
            </div>
        </footer>
        <!-- Firebase Authentication -->
        <script type="module" src="auth.js"></script>
        <script>
            const menuToggle = document.getElementById('menu-toggle');
            const navMenu = document.getElementById('nav-menu');
            const overlay = document.getElementById('overlay');

            menuToggle.addEventListener('click', () => {
                const isOpen = navMenu.classList.toggle('active');
                overlay.classList.toggle('active');
                menuToggle.classList.toggle('active');
                menuToggle.setAttribute('aria-expanded', isOpen);
                menuToggle.setAttribute('aria-label', isOpen ? 'メニューを閉じる' : 'メニューを開く');
            }
            );

            overlay.addEventListener('click', () => {
                navMenu.classList.remove('active');
                overlay.classList.remove('active');
                menuToggle.classList.remove('active');
                menuToggle.setAttribute('aria-expanded', 'false');
                menuToggle.setAttribute('aria-label', 'メニューを開く');
            }
            );
        </script>
    </body>
</html>
